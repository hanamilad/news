type ReelGroup {
  id: ID!
  title: String!
  user: User @belongsTo
  reels: [Reel!]! @hasMany
  cover_image: String
  is_active: Boolean
  sort_order: Int
  created_at: DateTime
  updated_at: DateTime
}

type Reel {
  id: ID!
  reel_group_id: ID
  description: String
  path: String
  type: TypeReel!
  is_active: Boolean
  sort_order: Int
  user: User @belongsTo
  group: ReelGroup @belongsTo
  created_at: DateTime
  updated_at: DateTime
}

enum TypeReel {
      image
      video
}

input ReelGroupInput {
  title: TranslatableInput!
  is_active: Boolean
  sort_order: Int
  reels: [ReelInput!]
}

input ReelInput {
  id: ID
  description: TranslatableInput
  path: Upload
  type: TypeReel!
  sort_order: Int
  is_active: Boolean
}

extend type Query {
  reels_for_admin(
    first: Int! @rules(apply: ["required", "integer", "min:1", "max:100"])
    page: Int @rules(apply: ["integer", "min:1"])
  ): ReelGroupPaginator!
    @guard(with: ["api"])
    @can(ability: "reel.view")
    @field(resolver: "App\\GraphQL\\Queries\\ReelQuery@reels_for_admin")
    
  reels_for_public(
    first: Int! @rules(apply: ["required", "integer", "min:1", "max:100"])
    page: Int @rules(apply: ["integer", "min:1"])
  ): ReelGroupPaginator!
    @field(resolver: "App\\GraphQL\\Queries\\ReelQuery@reels_for_public")
}

type ReelGroupPaginator {
  paginatorInfo: PaginatorInfo!
  data: [ReelGroup!]!
}

type PaginatorInfo {
  count: Int!
  currentPage: Int!
  firstItem: Int
  hasMorePages: Boolean!
  lastItem: Int
  lastPage: Int!
  perPage: Int!
  total: Int!
}

extend type Mutation {
  CreateReelGroup(input: ReelGroupInput!): ReelGroup
    @guard(with: ["api"])
    @can(ability: "reel.create")
    @field(resolver: "App\\GraphQL\\Mutations\\ReelGroupMutator@create")

  UpdateReelGroup(id: ID!, input: ReelGroupInput!): ReelGroup
    @guard(with: ["api"])
    @can(ability: "reel.update", find: "id", model: "App\\Models\\ReelGroup")
    @field(resolver: "App\\GraphQL\\Mutations\\ReelGroupMutator@update")

  DeleteReelGroup(id: ID!): Boolean
    @guard(with: ["api"])
    @can(ability: "reel.delete", find: "id", model: "App\\Models\\ReelGroup")
    @field(resolver: "App\\GraphQL\\Mutations\\ReelGroupMutator@delete")
}